# mecrury_esphome

За основу взят проект https://github.com/RocketFox2409/MercuryESPHome

disclaimer:
Сразу скажу, что я не проф. программист, поэтому код может где то быть не элегантен.

И так, была задача передавать показания со счетчика Меркурий 206 (RS-485) в Home Assistant. 

Изначально провод от счетчика шел через преобразователь USB-RS485 в сервер HomeAssistant на Raspberry и через Node-Red формировался запрос и принимался ответ. Все работало, но пришло время развиваться и убрать лишние провода. 

Было собрано 3 сетапа:

Первый сетап: Wemos D1 mini + RS485 (MAX485 chipset) + DC-DC конвертер для стабильного питания.
Подключение:
D1 (GPIO5) --> TX (RO)
D2 (GPIO4) --> RX (DI)
D4 (GPIO2) --> DE+RE
3.3V --> VCC
GND --> GND



Работает, но очень не стабильно, постоянно отваливается Wemos.

Во втором сетапе добавил дополнительный DС-DC для питания модуля RS485
Стало постабильнее, но все равно отваливается, так как в Wemos использовал SoftwareSerial

Третий сетап аналогичен второму, только Wemos заменил на ESP01s с HardwareSerial, работает стабильно. Больше трогать не буду. Отличие только:
GPIO0 -->DE+RE
